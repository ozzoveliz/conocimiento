jQuery(document).ready(function(e){function a(a,s,n){var i;e(".eckb-top-notice-message").html(""),e.ajax({type:a,dataType:"json",data:s,url:ajaxurl,beforeSend:function(e){o("show",n)}}).done(function(a){if((a=a||"").message||void 0===a.output)i=a.message?a.message:r("","Access Manager: Error occurred. Please try again later. (L01)","error");else{var o=void 0!==a.output&&a.output?a.output:r("","Please reload the page and try again (L37).","error");e("#amgr_license_check").html(o)}}).fail(function(e,a,o){i=r("Access Manager: Error occurred. Please try again later. (L02)",i=o?" ["+o+"]":"unknown error","error")}).always(function(){o("remove",""),i&&(e(".eckb-bottom-notice-message").replaceWith(i),e("html, body").animate({scrollTop:0},"slow"))})}function o(a,o){if("show"===a){let a='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(o?'<div class="epkb-admin-text">'+o+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(a)}else"remove"===a&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function r(e,a,o){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+o+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+'</span></div><div class="epkb-close-notice fa fa-window-close"></div></div>'}function s(a,o){if("show"===a){let a='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(o?'<div class="epkb-admin-text">'+o+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(a)}else"remove"===a&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function n(e,a,o){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+o+'">'+(e?"<h4>"+e+"</h4>":"")+(a?"<p>"+a+"</p>":"")+'</span></div><div class="epkb-close-notice epkbfa epkbfa-window-close"></div></div>'}wp&&wp.data&&wp.data.dispatch("core/edit-post")&&wp.data.dispatch("core/edit-post").removeEditorPanel("taxonomy-panel-"+amgr_vars.kb_taxonomy_name),e("#amgr-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide();var i=e("#ekcb-licenses");e("#wpbody").on("click","#eckb_license_tab",function(o){e("#amgr_license_check").html(""),a("GET",{action:"amgr_handle_license_request",command:"get_license_info"},"Retrieving license status. Please wait.")}),i.on("click","#amgr_save_btn",function(o){o.preventDefault();a("POST",{action:"amgr_handle_license_request",amgr_license_key:e("#amgr_license_key").val().trim(),_wpnonce_amgr_license_key:e("#_wpnonce_amgr_license_key").val(),command:"save"},"Saving license...")}),e(".amag-private-admin .postbox-container").css("opacity","0"),setTimeout(function(){e(".amag-private-admin .postbox-container").css("opacity","100")},2e3);e("#ekb-admin-page-wrap").find(" .amgr-access-config-inner").on("click",".info-icon",function(){e(this).find("p").toggle()}),e("body").on("click",".amgr_notice_reset_logs_ajax",function(){!function(a,o,s){var n,i,o=void 0===o?"amgr_callback_noop":o;e.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,beforeSend:function(a){e("#amgr-ajax-in-progress").text("Working ...").dialog("open")}}).done(function(e){((i=e||"").error||void 0===i.message)&&(n=i.message?i.message:r("",amgr_vars.reload_try_again,"error"))}).fail(function(e,a,o){n=o?" ["+o+"]":amgr_vars.unknown_error,n=r(amgr_vars.error_occurred+". "+amgr_vars.msg_try_again,n,"error")}).always(function(){e("#amgr-ajax-in-progress").dialog("close"),n?e(".eckb-bottom-notice-message").replaceWith(n):"function"==typeof o?o(i=void 0===i?"":i):s&&location.reload()})}({action:"amgr_reset_logs_ajax",_wpnonce_epkb_ajax_action:amgr_vars.nonce},null,!0)});let t=!1;e("#amgr_debug_user_search").on("keyup",function(){clearTimeout(t),e("#amgr_debug_user_id").text(""),e("#amgr_debug_user_name").text("-"),e("#amgr_debug_user_email").text("-"),e("#amgr_enable_debug_user_access").prop("disabled",!0),e(this).val()&&(t=setTimeout(function(){let a,o={action:"amgr_search_user",search:e("#amgr_debug_user_search").val(),_wpnonce_epkb_ajax_action:epkb_vars.nonce};e.ajax({type:"POST",dataType:"json",data:o,url:ajaxurl,beforeSend:function(a){e("body").append(n("",amgr_vars.search_user,"success")).removeClass("fadeOutDown"),e("#amgr_debug_user_search").blur(),e("#amgr_debug_user_search").prop("disabled",!0)}}).done(function(o){(o.error||void 0===o.message)&&(a=o.message?o.message:n("",amgr_vars.reload_try_again,"error")),void 0!==o.message&&(a=o.message),void 0!==o.id?e("#amgr_debug_user_id").text(o.id):e("#amgr_debug_user_id").text(amgr_vars.user_not_found),void 0!==o.name&&e("#amgr_debug_user_name").text(o.name),void 0!==o.email&&e("#amgr_debug_user_email").text(o.email),void 0!==o.message&&e("#amgr_debug_user_email").val(o.email)}).fail(function(e,o,r){a=r?" ["+r+"]":epkb_vars.unknown_error,a=n(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,a,"error")}).always(function(){if(e(".eckb-bottom-notice-message").remove(),e("#amgr_debug_user_search").prop("disabled",!1),e("#amgr_enable_debug_user_access").prop("disabled",!1),a)return e(".eckb-bottom-notice-message").remove(),e("body").append(a).removeClass("fadeOutDown"),void setTimeout(function(){e(".eckb-bottom-notice-message").addClass("fadeOutDown")},1e4)})},1500))}),e("#amgr_enable_debug_user_access").on("click",function(){let a,o={action:"amgr_save_debug_user_data",id:e("#amgr_debug_user_id").text(),enable:e('[name="amgr_debug_user_access"]').prop("checked")?"1":"",_wpnonce_epkb_ajax_action:epkb_vars.nonce};return e.ajax({type:"POST",dataType:"json",data:o,url:ajaxurl,beforeSend:function(e){s("show")}}).done(function(e){(e.error||void 0===e.message)&&(a=e.message?e.message:n("",amgr_vars.reload_try_again,"error")),void 0!==e.message&&(a=e.message)}).fail(function(e,o,r){a=r?" ["+r+"]":epkb_vars.unknown_error,a=n(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,a,"error")}).always(function(){if(s("remove",""),a)return e(".eckb-bottom-notice-message").remove(),e("body").append(a).removeClass("fadeOutDown"),void setTimeout(function(){e(".eckb-bottom-notice-message").addClass("fadeOutDown")},1e4)}),!1})});