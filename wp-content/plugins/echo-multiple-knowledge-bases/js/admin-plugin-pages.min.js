jQuery(document).ready(function(e){function a(){e("#emkb_license_check").html("");t("GET",{action:"emkb_handle_license_request",command:"get_license_info"},"Retrieving license status. Please wait.")}function t(a,t,i){var s;e(".eckb-top-notice-message").html(""),e.ajax({type:a,dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){n("show",i)}}).done(function(a){if((a=a||"").message||void 0===a.output)s=a.message?a.message:o("","Multiple Knowledge Bases: Error occurred. Please try again later. (L01)","error");else{var t=void 0!==a.output&&a.output?a.output:o("","Please reload the page and try again (L37).","error");e("#emkb_license_check").html(t)}}).fail(function(e,a,t){s=o("Multiple Knowledge Bases: Error occurred. Please try again later. (L02)",s=t?" ["+t+"]":"unknown error","error")}).always(function(){n("remove",""),s&&(e(".eckb-top-notice-message").remove(),e("body").append(s),e("html, body").animate({scrollTop:0},"slow"))})}function n(a,t){if("show"===a){let a='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(t?'<div class="epkb-admin-text">'+t+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(a)}else"remove"===a&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function o(e,a,t){return'<div class="eckb-top-notice-message"><div class="contents"><span class="'+t+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+"</span></div></div>"}e("#emkb-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide(),e("#emkb-create-kb-btn").length&&e("#ekb_core_top_heading").hide(),e("#emkb-create-kb-btn").on("click",function(e){e.preventDefault(),s.dialog("open")}),e("#emkb-create-wizard-kb-btn").on("click",function(a){a.preventDefault(),e("#emkb-add-kb").submit()}),e("#epkb-list-of-kbs").on("change",function(){let a=e(this).find("option:selected");"emkb"===a.attr("data-plugin")&&e(a.attr("data-target")).submit()}),function(){var a=e(".drop_down_tabs .active").attr("title");void 0!==a&&e(".drop_down_tabs").before('<li><a class="nav_tab active"><span class="active-tab-text"> '+a+"</span></a></li>"),e(".drop_down_tabs").on("click",function(){e(this).toggleClass("active-drop-down"),e(this).find("ul").toggle()})}();var i=e("#ekcb-licenses");e("#eckb_license_tab").hasClass("active")&&a(),e("#wpbody").on("click","#eckb_license_tab",function(e){a()}),i.on("click","#emkb_save_btn",function(a){a.preventDefault();t("POST",{action:"emkb_handle_license_request",emkb_license_key:e("#emkb_license_key").val().trim(),_wpnonce_emkb_license_key:e("#_wpnonce_emkb_license_key").val(),command:"save"},"Saving license...")});var s=e("#emkb-dialog-create-kb").dialog({resizable:!1,autoOpen:!1,modal:!0,buttons:{Create:function(){e("#emkb_kb_name_input").val(e("#emkb_kb_name").val()),e("#emkb_kb_slug_input").val(e("#emkb_kb_slug").val()),e(this).dialog("close"),e("#emkb-add-kb").submit()},Cancel:function(){e(this).dialog("close")}},close:function(){}});e(".block-editor").length>0&&setTimeout(function(){kb_tabs_html=e("#ekb_core_top_heading").clone(),e("#ekb_core_top_heading").remove(),e(".edit-post-header-toolbar").after(kb_tabs_html),e(".tab_navigation").before('<span class="epk-tab-nav-mobile-icon dashicons dashicons-welcome-learn-more"></span>');var a=e(".tab_navigation .active span").text();e("#ekb_core_top_heading").append('<span class="epk-tab-active-kb">'+a+"</span>"),e(".epk-tab-nav-mobile-icon").on("click",function(){e(this).toggleClass("epkb-active-tab-icon"),e(this).parents().find(".tab_navigation").toggle()}),e(".drop_down_tabs ul li").each(function(){li=e(this).clone(),e(".tab_navigation").append(li)}),e(".tab_navigation").prepend('<i class="ekb-tab-nav-arrow-icon epkbfa epkbfa-sort-asc" aria-hidden="true"></i>')},1e3),e(".emkb-delete-kbs .error-btn").on("click",function(){return e(this).closest(".emkb-delete-kbs").find(".emkb-dialog-box-form").toggleClass("emkb-dialog-box-form--active"),!1}),e(".emkb-dbf__close, .emkb-dbf__footer__cancel__btn").on("click",function(){e(this).closest(".emkb-dialog-box-form").toggleClass("emkb-dialog-box-form--active")}),e(".emkb-delete-kbs .emkb-dbf__footer__accept__btn").on("click",function(){e(this).closest("form").length&&e(this).closest("form").submit()})});