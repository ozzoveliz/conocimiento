jQuery(document).ready(function(a){function e(e){a("#asea_datatable").html(e)}function n(){a("#asea_license_check").html("");s("GET",{action:"asea_handle_license_request",command:"get_license_info"},"Retrieving license status. Please wait.",t)}function t(e){a("#asea_license_check").html(e)}function s(e,n,t,s){var c;a(".eckb-top-notice-message").html(""),a.ajax({type:e,dataType:"json",data:n,url:ajaxurl,beforeSend:function(a){o("show",t)}}).done(function(a){if((a=a||"").message||void 0===a.output)c=a.message?a.message:i("","Advanced Search: Error occurred. Please try again later. (L01)","error");else{var e=void 0!==a.output&&a.output?a.output:i("","Please reload the page and try again (L37).","error");s(e)}}).fail(function(a,e,n){c=i("Advanced Search: Error occurred. Please try again later. (L02)",c=n?" ["+n+"]":"unknown error","error")}).always(function(){o("remove",""),c&&(a(".eckb-top-notice-message").remove(),a("body").append(c),a("html, body").animate({scrollTop:0},"slow"))})}function o(e,n){if("show"===e){var t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(n?'<div class="epkb-admin-text">'+n+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';a("body").append(t)}else"remove"===e&&(a(".epkb-admin-dialog-box-loading").remove(),a(".epkb-admin-dialog-box-overlay").remove())}function i(a,e,n){return'<div class="eckb-top-notice-message"><div class="contents"><span class="'+n+'">'+(a?"<h4>"+a+"</h4>":"")+(e||"")+"</span></div></div>"}function c(a,e,n){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+n+'">'+(a?"<h4>"+a+"</h4>":"")+(e||"")+'</span></div><div class="epkb-close-notice epkbfa epkbfa-window-close"></div></div>'}if(a("#asea-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide(),a("#asea_datatable").length){a("#asea_datatable").DataTable();var r=moment().subtract(7,"days"),d=moment();a("#reportrange").daterangepicker({startDate:r,endDate:d,maxDate:d,maxSpan:{months:12},autoUpdateInput:!1,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}},function(a,e,n){l(a,e,n)});function l(n,t,o){a("#reportrange span").html(" &nbsp;&nbsp;<strong>"+o+"</strong>: &nbsp;&nbsp;"+n.format("MMM D, YYYY")+" - "+t.format("MMM D, YYYY")+"&nbsp;&nbsp;&nbsp;");s("POST",{action:"asea_handle_search_analytics",kb_id:a("#eckb_kb_id").val(),start_date:n.format("YYYY-MM-DD"),end_date:t.format("YYYY-MM-DD"),_wpnonce_asea_search_analytics:a("#_wpnonce_asea_search_analytics").val()},"Getting data...",e)}l(r,d,"Last 7 days")}var _=a("#ekcb-licenses");if(a("#eckb_license_tab").hasClass("active")&&n(),a("#wpbody").on("click","#eckb_license_tab",function(a){n()}),_.on("click","#asea_save_btn",function(e){e.preventDefault();s("POST",{action:"asea_handle_license_request",asea_license_key:a("#asea_license_key").val().trim(),_wpnonce_asea_license_key:a("#_wpnonce_asea_license_key").val(),command:"save"},"Saving license...",t)}),a("#wpbody-content").on("click",".asea-search-toggle",function(){a(this).closest(".epkb-wc-step-panel").find(".asea-advanced-search-container, .asea-advanced-search-container").slideToggle()}),a(".asea-config-container").length&&(a(".asea-config-content__tab-button").click(function(){return a(this).parent().find(".asea-config-content__tab-button").removeClass("active"),a(this).addClass("active"),a(this).closest(".asea-config-content").find(".asea-config-content__tab").removeClass("active"),a(a(this).data("target")).addClass("active"),!1}),a(".asea-config-container").on("click","#asea_search_config_save",function(e){e.preventDefault();let n,t=a(this).data("action");if("asea_synonyms_update"===t)n={action:"asea_search_config_save",data_action:t,asea_kb_id:a('.asea-synonyms-form input[name="asea_kb_id"]').val(),asea_search_synonyms:a('.asea-synonyms-form textarea[name="asea_search_synonyms"]').val(),_wpnonce_asea_config:a('.asea-synonyms-form input[name="_wpnonce_asea_config"]').val()};else if("asea_debug_update"===t){let e;e=a('.asea-debug-form input[name="asea_debug"]').prop("checked")?"on":"off",n={action:"asea_search_config_save",data_action:t,asea_kb_id:a('.asea-debug-form input[name="asea_kb_id"]').val(),asea_debug:e,_wpnonce_asea_config:a('.asea-debug-form input[name="_wpnonce_asea_config"]').val()}}let s;a.ajax({type:"POST",dataType:"json",data:n,url:ajaxurl,beforeSend:function(a){o("show","Saving")}}).done(function(a){((a=a||"").error||void 0===a.message||void 0===a.kb_info_panel_output)&&(s=c("",a.message,"error"))}).fail(function(a,e,n){s=n?" ["+n+"]":epkb_vars.unknown_error,s=c("Advanced Search: Error occurred. Please try again later. (L02)",s,"error")}).always(function(){o("remove",""),s&&(a(".eckb-bottom-notice-message").replaceWith(s),a("html, body").animate({scrollTop:0},"slow"))})}),a(".asea-config-container, #epkb-admin__boxes-list__asea-search").on("click","#asea_audit_clear",function(e){e.preventDefault();let n,t={action:"asea_search_audit_clear",asea_kb_id:a(this).data("kb_id"),_wpnonce_asea_config:a(this).data("nonce")};a.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(a){o("show","Clearing")}}).done(function(e){if((e=e||"").error||void 0===e.message||void 0===e.kb_info_panel_output)return a("#asea_audit_textarea").val(""),void(n=c("",e.message,"error"))}).fail(function(a,e,t){n=t?" ["+t+"]":epkb_vars.unknown_error,n=c("Advanced Search: Error occurred. Please try again later. (L02)",n,"error")}).always(function(){o("remove",""),n&&(a(".eckb-bottom-notice-message").replaceWith(n),a("html, body").animate({scrollTop:0},"slow"))})})),a("#asea_audit_download").length){let e=a("#asea_audit_textarea").val();a("#asea_audit_download").prop("href","data:text/plain;charset=utf-8,"+e)}});