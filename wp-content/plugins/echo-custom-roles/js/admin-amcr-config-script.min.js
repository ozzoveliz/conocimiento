jQuery(document).ready(function(r){var m=r("#amag-access-manager-container"),e=r("#amcr-wp-roles-content");function a(a){e.html(),e.html(a.message),r(".amag-config-content").hide(),r("#amcr-wp-roles-content").show()}function i(a,n,o,e,i){var m=t(n,o);if(m)return r(".eckb-bottom-notice-message").replaceWith(m),void r("html, body").animate({scrollTop:0},"slow");s({action:a,amag_kb_id:r("#amag_kb_id").val(),amcr_wp_role_name:n,amcr_kb_group_id:e,amcr_kb_role_name:o,_wpnonce_amar_access_content_action_ajax:r("#_wpnonce_amar_access_content_action_ajax").val()},i)}function t(a,n){return!(!n||n.size<3)&&(!(!a||a.size<3)&&"")}function c(){s({action:"amcr_display_wp_roles_tabs_ajax",amag_kb_id:r("#amag_kb_id").val(),_wpnonce_amar_access_content_action_ajax:r("#_wpnonce_amar_access_content_action_ajax").val()},a)}function n(a){r("#amcr-user-tabs-section").html(a.message)}function s(a,n,o){var e,i;n=void 0===n?"amcr_callback_noop":n;r.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,beforeSend:function(a){r("#amcr-ajax-in-progress").text("Working ...").dialog("open")}}).done(function(a){((i=a||"").error||void 0===i.message)&&(e=i.message?i.message:g("",amcr_vars.reload_try_again,"error"))}).fail(function(a,n,o){e=o?" ["+o+"]":amcr_vars.unknown_error,e=g(amcr_vars.error_occurred+". "+amcr_vars.msg_try_again,e,"error")}).always(function(){r("#amcr-ajax-in-progress").dialog("close"),e?(m.find(".amag-ajax-loading-saving-icon").remove(),r(".eckb-bottom-notice-message").replaceWith(e)):(!function(){if(0!==r(".amag-ajax-loading-saving-icon").length){var a;m.find(".amag-loading-spinner").after('<div class="epkbfa epkbfa-check-circle"></div>'),m.find(".amag-loading-spinner").remove(),clearTimeout(a),a=setTimeout(function(){m.find(".amag-ajax-loading-saving-icon").remove()},1e3)}}(),"function"==typeof n?n(i=void 0===i?"":i):o&&location.reload())})}function l(){if(!(0<r(".amag-ajax-loading-saving-icon").length)){m.find(".amag-ajax-loading-saving-icon").remove();m.append('<div class="amag-ajax-loading-saving-icon"><div class="amag-loading-spinner"></div></div>')}}function g(a,n,o){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+o+'">'+(a?"<h4>"+a+"</h4>":"")+(n||"")+'</span></div><div class="amcr-close-notice epkbfa epkbfa-window-close"></div></div>'}m.find("#amgr-config-main-nav").on("click",".amag-nav-button",function(){0<r(".amag-ajax-loading-saving-icon").length||"amag-wp-roles"===r(this).attr("id")&&(l(),c())}),e.on("click","#amcr-add-wp-role-map",function(){r(this).toggleClass("amcr-btn-active"),r("#amcr-add-wp-role-map-input").fadeToggle().css("display","inline-block")}),e.on("click","#amcr_add_wp_role_map_ajax",function(){var a=r("#create-wp-role-name").val(),n=r("#create-kb-group-id").val(),o=r("#create-kb-role-name").val();l(),i("amcr_add_wp_role_ajax",a,o,n,c),e.find("#amcr-add-wp-role-map").removeClass("amcr-btn-active"),e.find("#create-wp-role-name").val(" "),r("#amcr-add-wp-role-map-input").fadeOut()}),e.on("click","[id^=amcr-delete-wp-role-map]",function(){r(".amag-popup").remove();var a=r(this).parent().parent().find(".amcr_wp_role_name").text(),n=r(this).parent().parent().find(".amcr_kb_group_id").val(),o=r(this).parent().parent().find(".amcr_kb_role_name").text(),e=t(a,o);if(e)return r(".eckb-bottom-notice-message").replaceWith(e),void r("html, body").animate({scrollTop:0},"slow");l(),i("amcr_delete_wp_role_ajax",a,o,n,c)}),r("#amcr-access-save-configuration-container").on("click","#amcr_save_kb_config",function(a){a.preventDefault(),l(),s({action:"amcr_save_kb_config_changes",amag_kb_id:r("#amag_kb_id").val(),form:r("#amcr-access-configuration").serialize(),_wpnonce_amcr_save_kb_config:r("#_wpnonce_amcr_save_kb_config").val()},n)}),m.find(".amag-notification-box").on("click",".amag-content-toggle",function(){r(this).parents(".amag-collapse").find(".amag-body-checkboxes").fadeToggle(100),r(this).parents(".amag-collapse").find(".amcr-footer").fadeToggle(100),r(this).parents(".amag-collapse").find(".fa").toggleClass("fa-arrow-circle-down fa-arrow-circle-up"),r(this).parents(".amag-collapse").toggleClass("amag-active-toggle")}),m.on("click",".amcr-toggle-box-header",function(){r(this).parent().toggleClass("amcr-toggle-closed amcr-toggle-open "),r(this).find(".amcr-toggle-box-icon").toggleClass("fa-arrow-circle-down fa-arrow-circle-up ")}),m.on("click",".amcr-info-box-icon",function(){r(this).parent().toggleClass("amcr-info-toggle-closed amcr-info-toggle-open ")}),m.on("click",".amcr-info-box-close",function(){r(this).parents(".amcr-info-box").toggleClass("amcr-info-toggle-closed amcr-info-toggle-open ")}),m.on("click",".amcr-info-box-icon-max",function(){r(this).parents(".amcr-info-box").addClass("amcr-info-max-size"),r(this).hide(),r(this).parent().find(".amcr-info-box-icon-min").show()}),m.on("click",".amcr-info-box-icon-min",function(){r(this).parents(".amcr-info-box").removeClass("amcr-info-max-size"),r(this).hide(),r(this).parent().find(".amcr-info-box-icon-max").show()})});